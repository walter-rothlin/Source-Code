<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--    
    Source:    ./DatenFiles/HTML/FormTest_formHandler.html
    Published: https://hwz.peterliwiese.ch/examples/FormTest_formHandler.html



	Ehrenwörtliche Erklärung
	------------------------
   
	Hiermit bestätige ich, Cristiano Guerra, diesen Leistungsnachweis 
	ohne fremde Hilfe nur mit den erlaubten Hilfsmittel während der offiziellen 
	vereinbarten Zeitdauer erstellt zu haben.

	Bewertung
	---------
	1) Richtiger Filename / Ehrenwörtliche Erklärung
	2) Korrekte Formatierung
	3) Korrektes XHTML
	4) Korrekte zusätzliche Felder (inkl. title und body)
	5) CSS eingebunden
	6) Erweitertes Antwort-Template eingebunden
	7) Feldernamen entsprechend neuem Antwort-Template angepasst
	8) Postleitzahl wird Clientseitig überprüft (korrigiert)
	9) Warnungs-Symbol mit CSS-Style zugefügt
	10) Eventhadler eingebaut und Symbole ändern
	                                                                 --------
	                                                         Punkte:
	                                                                 --------
	                                       Note = 0.5 * Punkte + 1 =
	                                                                 ========
	-->

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>Anmeldeformular für Geschäftsanlasse</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

    <!-- HWZ-Style (macht den Titel rot) -->
    <link rel="stylesheet" type="text/css"
          href="https://hwz.peterliwiese.ch/examples/CSS_HWZ_Style_01.css" />

    <style type="text/css">
        table.anmeldeTabelle td {
            padding: 3px 6px;
        }

        .iconStatus {
            width: 20px;
            height: 20px;
            vertical-align: middle;
            margin-left: 4px;
        }

        .invalidField {
            background-color: #ff0000;
        }

        .validField {
            background-color: #ffffff;
        }
	
    	input[type="radio"]:checked {
        	accent-color: blue;
   	}

    	input[type="checkbox"]:checked {
        	accent-color: blue;
    	}
    </style>

    <script type="text/javascript">
    //<![CDATA[
        var warningIcon = "https://www.peterliwiese.ch/img/Warning.svg";
        var verifiedIcon = "https://www.peterliwiese.ch/img/Verified.svg";

        function setIcon(iconId, isValid) {
            var icon = document.getElementById(iconId);
            if (!icon) {
                return;
            }
            if (isValid) {
                icon.setAttribute("src", verifiedIcon);
            } else {
                icon.setAttribute("src", warningIcon);
            }
        }

        function setFieldStyle(field, isValid) {
            if (isValid) {
                field.className = "validField";
            } else {
                field.className = "invalidField";
            }
        }

        // einfache Regel: mindestens 4 Zeichen = gültig
        function validateName(field, iconId) {
            var value = field.value;
            var isValid = (value.length >= 4);
            setIcon(iconId, isValid);
            setFieldStyle(field, isValid);
        }

        function validateEmail(field, iconId) {
            var value = field.value;
            var re = /^[^@\s]+@[^@\s]+\.[^@\s]+$/;
            var isValid = re.test(value);
            setIcon(iconId, isValid);
            setFieldStyle(field, isValid);
        }

        function checkPLZ(field) {
            var plz = field.value;
            var re = /^[0-9]{4}$/;
            var isValid = re.test(plz);
            if (!isValid && plz !== "") {
                alert("Bitte geben Sie eine vierstellige Postleitzahl (nur Ziffern) ein.");
                field.value = "";
                field.focus();
            }
            setFieldStyle(field, isValid || plz === "");
        }
    //]]>
    </script>
</head>

<body>
    <!-- Titel – wird durch CSS rot gerendert -->
    <h2>Anmeldeformular für Geschäftsanlasse</h2>

    <form method="get" name="anmeldeForm"
          action="https://www.peterliwiese.ch/cgi-bin/formHandler.pl">

        <p>Hiermit melde ich mich für den Anlass vom</p>

        <table class="anmeldeTabelle">
            <tbody>
                <tr>
                    <td>Name:</td>
                    <td>
                        <input type="text" name="Name" id="fldName"
                               value="Guerra"
                               onkeyup="validateName(this, 'iconName');" />
                        <img id="iconName" class="iconStatus"
                             src="https://www.peterliwiese.ch/img/Warning.svg"
                             alt="Status Name" />
                    </td>
                </tr>
                <tr>
                    <td>Vorname:</td>
                    <td>
                        <input type="text" name="Vorname" id="fldVorname"
                               value="Cristiano"
                               onkeyup="validateName(this, 'iconVorname');" />
                        <img id="iconVorname" class="iconStatus"
                             src="https://www.peterliwiese.ch/img/Warning.svg"
                             alt="Status Vorname" />
                    </td>
                </tr>
                <tr>
                    <td>email:</td>
                    <td>
                        <input type="text" name="Email" id="fldEmail"
                               size="30" value="cristianovelada@gmail.com"
                               onkeyup="validateEmail(this, 'iconEmail');" />
                        <img id="iconEmail" class="iconStatus"
                             src="https://www.peterliwiese.ch/img/Warning.svg"
                             alt="Status Email" />
                    </td>
                </tr>
                <tr>
                    <td>PLZ:</td>
                    <td>
                        <input type="text" name="PLZ" size="4" maxlength="4"
                               value="8152" onchange="checkPLZ(this);" />
                        Wohnort:
                        <input type="text" name="Wohnort" value="Glattpark" />
                    </td>
                </tr>
                <tr>
                    <td>ÖV Vergünstigung:</td>
                    <td>
                        <input type="radio" name="SbbVaucher" value="Nichts" /> Nichts
    			<input type="radio" name="SbbVaucher" value="1/2 Preis" /> 1/2 Preis
    			<input type="radio" name="SbbVaucher" value="GA" /> GA
                    </td>
                </tr>
                <tr>
                    <td>Mittagessen:</td>
                    <td>
                        <input type="checkbox" name="Vegan" value="on" /> Vegan
                    </td>
                </tr>
                <tr>
                    <td></td>
                    <td>
                        Ich komme in Begleitung von
                        <select name="Begleitpersonen">
				<option value="0">keiner</option>
				<option value="1">1</option>
    				<option value="2">2</option>
    				<option value="3">3</option>
   				<option value="4">4</option>
                        </select>
                        weiteren Person(en)
                    </td>
                </tr>
                <tr>
                    <td>Kommentar:</td>
                    <td>
                        <textarea name="Kommentar" rows="5" cols="40"></textarea>
                    </td>
                </tr>
            </tbody>
        </table>

        <!-- Hidden-Felder für formHandler.pl -->
        <input type="hidden" name="constrain_PLZ"
               value="isInteger(XXXX,1000,9999,&lt;B&gt;Postleitzahl&lt;/B&gt; muss zwischen 1000 und 9999 sein)" />
        <input type="hidden" name="cgiCmdHidden_replyTemplateSuccess"
               value="http://www.hwz.peterliwiese.ch/examples/testSuccessTemplate_01.html" />
        <input type="hidden" name="cgiCmdHidden_replyTemplateNotSuccess"
               value="http://www.hwz.peterliwiese.ch/examples/testNotSuccessTemplate.html" />
        <input type="hidden" name="cgiCmdHidden_emailTemplate"
               value="http://www.hwz.peterliwiese.ch/examples/testEmailTemplate.html" />
        <input type="hidden" name="cgiCmdHidden_emailSubject"
               value="Antwort (Default as HTML)" />
        <input type="hidden" name="cgiCmdHidden_emailToAddrs"
               value="anmeldung@peterliwiese.ch" />
        <input type="hidden" name="cgiCmdHidden_emailCcAddrs" value="" />
        <input type="hidden" name="cgiCmdHidden_emailBccAddrs" value="" />
        <input type="hidden" name="cgiCmdHidden_emailFromAddr"
               value="FormField:Email" />
        <input type="hidden" name="cgiCmdHidden_emailSentAsHTML"
               value="YES" />

        <input type="hidden" name="cgiCmdHidden_emailTemplate_1"
               value="http://www.hwz.peterliwiese.ch/examples/testEmailTemplate.txt" />
        <input type="hidden" name="cgiCmdHidden_emailSubject_1"
               value="Antwort as plain txt mail" />
        <input type="hidden" name="cgiCmdHidden_emailToAddrs_1"
               value="FormField:Email" />
        <input type="hidden" name="cgiCmdHidden_emailFromAddr_1"
               value="anmeldung@peterliwiese.ch" />
        <input type="hidden" name="cgiCmdHidden_emailSentAsHTML_1"
               value="NO" />
        <input type="hidden" name="cgiCmdHidden_countOfEmails"
               value="2" />
        <input type="hidden" name="cgiCmdHidden_doDebug"
               value="Yes" />

        <p>
            <input type="submit" name="submitted" value="Anmelden" />
            <input type="reset" value="Eingaben löschen" />
        </p>
    </form>
</body>
</html>
